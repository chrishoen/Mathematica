(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33291,        929]
NotebookOptionsPosition[     30677,        842]
NotebookOutlinePosition[     31450,        868]
CellTagsIndexPosition[     31407,        865]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Initialize.", "Text",
 CellChangeTimes->{{3.677155481291274*^9, 3.67715548495728*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearSystemCache", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ParentDirectory", "[", 
      RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<Lib\>\"", 
     ",", "\"\<Rotations.m\>\""}], "}"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6771515156172924`*^9, 3.677151558334167*^9}, {
  3.6771537852052584`*^9, 3.6771537910708685`*^9}}],

Cell["\<\
Here are three matrices that define rotations about coordinate X,Y,Z axis.\
\>", "Text",
 CellChangeTimes->{{3.6771515628737745`*^9, 3.6771515661341805`*^9}, 
   3.677151616150868*^9, {3.6771538211069217`*^9, 3.6771538783152213`*^9}, {
   3.677155243820858*^9, 3.6771552481752653`*^9}, {3.6771554968621016`*^9, 
   3.6771554973769026`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"RotateX", "[", "a", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotateY", "[", "a", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotateZ", "[", "a", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6744984596458035`*^9, 3.674498483999446*^9}, 
   3.6771515386147327`*^9, {3.6771516199728746`*^9, 3.677151620160075*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", 
      RowBox[{"Cos", "[", "a", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "a", "]"}]}]},
     {"0", 
      RowBox[{"Sin", "[", "a", "]"}], 
      RowBox[{"Cos", "[", "a", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.677165669640915*^9, 3.6771657792471066`*^9, 3.677165823340784*^9, 
   3.677165908723134*^9, {3.6771659589808226`*^9, 3.6771659975510902`*^9}, 
   3.6771660717266197`*^9, 3.6771661077610836`*^9, {3.6771661424313445`*^9, 
   3.677166220886282*^9}, 3.677166598344545*^9, 3.6771675173157578`*^9, {
   3.6771677132461023`*^9, 3.6771677280671277`*^9}, {3.6771690733090887`*^9, 
   3.6771691050933437`*^9}, 3.677169200879912*^9, 3.6771692582024126`*^9, 
   3.677169288260865*^9, {3.6771694095770783`*^9, 3.67716943333692*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "a", "]"}], "0", 
      RowBox[{"Sin", "[", "a", "]"}]},
     {"0", "1", "0"},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "a", "]"}]}], "0", 
      RowBox[{"Cos", "[", "a", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.677165669640915*^9, 3.6771657792471066`*^9, 3.677165823340784*^9, 
   3.677165908723134*^9, {3.6771659589808226`*^9, 3.6771659975510902`*^9}, 
   3.6771660717266197`*^9, 3.6771661077610836`*^9, {3.6771661424313445`*^9, 
   3.677166220886282*^9}, 3.677166598344545*^9, 3.6771675173157578`*^9, {
   3.6771677132461023`*^9, 3.6771677280671277`*^9}, {3.6771690733090887`*^9, 
   3.6771691050933437`*^9}, 3.677169200879912*^9, 3.6771692582024126`*^9, 
   3.677169288260865*^9, {3.6771694095770783`*^9, 3.67716943333692*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "a", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "a", "]"}]}], "0"},
     {
      RowBox[{"Sin", "[", "a", "]"}], 
      RowBox[{"Cos", "[", "a", "]"}], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.677165669640915*^9, 3.6771657792471066`*^9, 3.677165823340784*^9, 
   3.677165908723134*^9, {3.6771659589808226`*^9, 3.6771659975510902`*^9}, 
   3.6771660717266197`*^9, 3.6771661077610836`*^9, {3.6771661424313445`*^9, 
   3.677166220886282*^9}, 3.677166598344545*^9, 3.6771675173157578`*^9, {
   3.6771677132461023`*^9, 3.6771677280671277`*^9}, {3.6771690733090887`*^9, 
   3.6771691050933437`*^9}, 3.677169200879912*^9, 3.6771692582024126`*^9, 
   3.677169288260865*^9, {3.6771694095770783`*^9, 3.67716943335252*^9}}]
}, Open  ]],

Cell["\<\
The body coordinate system for the sensor is defined as follows: Place the \
sensor on a table with the label facing up. The X axis cuts the two mounting \
screw holes, with positive X going to the right. The Y axis cuts the sensor \
cable, with negative Y going out along the cable. The Z axis goes up.

The sensor provides two angle measurements: TiltAngleX, which obtains if the \
sensor is rotated about its X axis. TiltAngleY, which obtains if the sensor \
is rotated about its Y axis. Angle sign conventions follow standard right \
handed coordinate system conventions.

For the test fixture, the sensor is placed on the shaft so that the positive \
Y axis is forward and the positive Z axis is up. The Y axis is longitudinal \
and the X axis is traverse.\
\>", "Text",
 CellChangeTimes->{{3.67716366679877*^9, 3.677163691574613*^9}, {
  3.6771637401737027`*^9, 3.6771637485353174`*^9}, {3.6771637818337803`*^9, 
  3.67716378752779*^9}, {3.677163819839446*^9, 3.677164048458457*^9}, {
  3.677164089390131*^9, 3.6771641132787733`*^9}, {3.677164157292657*^9, 
  3.677164288248088*^9}, {3.677164503974467*^9, 3.677164547477343*^9}}],

Cell["\<\
Here I use two coordinate systems, S0 and S1, where S0 is lab coordinates and \
S1 is body coordinates. For two successive rotations about body axis, by \
pitch and roll angles (First rotate the body about its X axis by a pitch \
angle, second rotate the body about its Y axis by a roll angle) L01 is the \
coordinate transformation matrix used to transform the components of a vector \
from S1 to S0. Given a vector A with components A0 in the S0 system and A1 in \
the S1 system, then the components transform by A0 = L01.A1.\
\>", "Text",
 CellChangeTimes->{
  3.677152971799038*^9, {3.6771530267297335`*^9, 3.6771531445959396`*^9}, {
   3.6771531756419935`*^9, 3.6771534408710566`*^9}, {3.677155538823575*^9, 
   3.677155543519183*^9}, {3.6771556033396883`*^9, 3.677155652940175*^9}, {
   3.677155722790498*^9, 3.677155816703062*^9}, {3.6771597311330595`*^9, 
   3.6771597371234703`*^9}, {3.6771631565205336`*^9, 3.677163221407047*^9}, {
   3.6771643071125207`*^9, 3.677164314244733*^9}}],

Cell["\<\
This describes our test fixture: First the Fore shaft is rotated about its X \
body axis by a pitch angle and then it is rotated  about its body Y axis by a \
roll angle.

Here are  the rotation matrices given as functions of pitch and roll angles:\
\>", "Text",
 CellChangeTimes->{{3.677159739354274*^9, 3.677159935367017*^9}, {
   3.6771632304238625`*^9, 3.6771632420644827`*^9}, {3.677163286885361*^9, 
   3.6771633997615585`*^9}, {3.6771643297405605`*^9, 
   3.6771643366377726`*^9}, {3.6771646061932464`*^9, 3.677164644220315*^9}, 
   3.677164727264661*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ctL01", "[", 
    RowBox[{"AP_", ",", "AR_"}], "]"}], "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"RotateX", "[", "AP", "]"}], ".", 
     RowBox[{"RotateY", "[", "AR", "]"}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ctL10", "[", 
    RowBox[{"AP_", ",", "AR_"}], "]"}], "=", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"ctL01", "[", 
      RowBox[{"AP", ",", "AR"}], "]"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ctL01", "[", 
   RowBox[{"AP", ",", "AR"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ctL10", "[", 
   RowBox[{"AP", ",", "AR"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6744984974642696`*^9, 3.6744985071518865`*^9}, {
   3.67449868286364*^9, 3.674498703003275*^9}, {3.6744987755774035`*^9, 
   3.6744987974974422`*^9}, {3.6744995035707245`*^9, 
   3.6744995185685844`*^9}, {3.6771516701133623`*^9, 3.6771516744189696`*^9}, 
   3.6771536279701834`*^9, {3.677155703118863*^9, 3.6771557076896715`*^9}, {
   3.677164393792673*^9, 3.677164440482955*^9}, {3.6771645824596043`*^9, 
   3.6771645829588056`*^9}, {3.6771649221696033`*^9, 
   3.6771649228716044`*^9}, {3.6771649638764763`*^9, 3.677164995722132*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "AR", "]"}], "0", 
      RowBox[{"Sin", "[", "AR", "]"}]},
     {
      RowBox[{
       RowBox[{"Sin", "[", "AP", "]"}], " ", 
       RowBox[{"Sin", "[", "AR", "]"}]}], 
      RowBox[{"Cos", "[", "AP", "]"}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "AR", "]"}]}], " ", 
       RowBox[{"Sin", "[", "AP", "]"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "AP", "]"}]}], " ", 
       RowBox[{"Sin", "[", "AR", "]"}]}], 
      RowBox[{"Sin", "[", "AP", "]"}], 
      RowBox[{
       RowBox[{"Cos", "[", "AP", "]"}], " ", 
       RowBox[{"Cos", "[", "AR", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.677165669718915*^9, 3.6771657792627068`*^9, 3.6771658233563843`*^9, 
   3.6771659087387342`*^9, {3.6771659590120225`*^9, 3.67716599756669*^9}, 
   3.67716607175782*^9, 3.677166107776684*^9, {3.677166142446944*^9, 
   3.6771662209028826`*^9}, 3.6771665983601446`*^9, 3.6771675173469577`*^9, {
   3.677167713261702*^9, 3.677167728082728*^9}, {3.6771690733246884`*^9, 
   3.677169105108944*^9}, 3.677169200911112*^9, 3.6771692582180123`*^9, 
   3.6771692882764654`*^9, {3.677169409592678*^9, 3.67716943335252*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "AR", "]"}], 
      RowBox[{
       RowBox[{"Sin", "[", "AP", "]"}], " ", 
       RowBox[{"Sin", "[", "AR", "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "AP", "]"}]}], " ", 
       RowBox[{"Sin", "[", "AR", "]"}]}]},
     {"0", 
      RowBox[{"Cos", "[", "AP", "]"}], 
      RowBox[{"Sin", "[", "AP", "]"}]},
     {
      RowBox[{"Sin", "[", "AR", "]"}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "AR", "]"}]}], " ", 
       RowBox[{"Sin", "[", "AP", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "AP", "]"}], " ", 
       RowBox[{"Cos", "[", "AR", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.677165669718915*^9, 3.6771657792627068`*^9, 3.6771658233563843`*^9, 
   3.6771659087387342`*^9, {3.6771659590120225`*^9, 3.67716599756669*^9}, 
   3.67716607175782*^9, 3.677166107776684*^9, {3.677166142446944*^9, 
   3.6771662209028826`*^9}, 3.6771665983601446`*^9, 3.6771675173469577`*^9, {
   3.677167713261702*^9, 3.677167728082728*^9}, {3.6771690733246884`*^9, 
   3.677169105108944*^9}, 3.677169200911112*^9, 3.6771692582180123`*^9, 
   3.6771692882764654`*^9, {3.677169409592678*^9, 3.67716943336812*^9}}]
}, Open  ]],

Cell["\<\
The gravity vector is a unit vector in the direction of gravity. \
\[OpenCurlyDoubleQuote]Down is where it goes\[CloseCurlyDoubleQuote].The \
gravity vector in the lab coordinate system is:\
\>", "Text",
 CellChangeTimes->{{3.6771536660042505`*^9, 3.677153731849165*^9}, {
  3.6771571599286194`*^9, 3.677157170271437*^9}, {3.67716466407055*^9, 
  3.67716469853701*^9}, {3.6771647666003304`*^9, 3.6771647945157785`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"G0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"G0", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6771535335080185`*^9, 3.677153534631221*^9}, {
  3.6771536307937884`*^9, 3.677153649312021*^9}, {3.6771647369230776`*^9, 
  3.6771647587047157`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {
       RowBox[{"-", "1"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.677165669718915*^9, 3.677165779278307*^9, 3.6771658233719845`*^9, 
   3.6771659087543344`*^9, {3.6771659590120225`*^9, 3.6771659975822897`*^9}, 
   3.6771660717734203`*^9, 3.6771661077922835`*^9, {3.6771661424625444`*^9, 
   3.6771662209184823`*^9}, 3.677166598391345*^9, 3.6771675173469577`*^9, {
   3.677167713277302*^9, 3.6771677280983276`*^9}, {3.677169073340288*^9, 
   3.677169105124544*^9}, 3.677169200926712*^9, 3.677169258233612*^9, 
   3.6771692882920656`*^9, {3.6771694096082783`*^9, 3.67716943336812*^9}}]
}, Open  ]],

Cell["\<\
If the text fixture sensor is rotated about its X body axis in pitch and then \
rotated about its Y body axis in roll then the gravity vector in the body \
system is:\
\>", "Text",
 CellChangeTimes->{
  3.6744995262709293`*^9, {3.6771564634885955`*^9, 3.6771565063634706`*^9}, {
   3.6771568102488065`*^9, 3.6771568824079328`*^9}, {3.677164828593239*^9, 
   3.6771648473046713`*^9}, {3.67716511386854*^9, 3.677165144156193*^9}, {
   3.6771652739890203`*^9, 3.677165319664301*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"G1", " ", "=", " ", 
   RowBox[{
    RowBox[{"ctL10", "[", 
     RowBox[{"AP", ",", "AR"}], "]"}], ".", "G0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"G1", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.677156727509862*^9, 3.6771568059119987`*^9}, 
   3.6771571883568687`*^9, {3.6771576596318245`*^9, 3.677157660458626*^9}, {
   3.6771648508458776`*^9, 3.677164902792369*^9}, {3.677165066418856*^9, 
   3.6771650671520576`*^9}, {3.677169036791623*^9, 3.677169037010023*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"Cos", "[", "AP", "]"}], " ", 
        RowBox[{"Sin", "[", "AR", "]"}]}]},
      {
       RowBox[{"-", 
        RowBox[{"Sin", "[", "AP", "]"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "AP", "]"}]}], " ", 
        RowBox[{"Cos", "[", "AR", "]"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.677165669734515*^9, 3.677165779293907*^9, 3.6771658233875847`*^9, 
   3.6771659087543344`*^9, {3.677165959027622*^9, 3.6771659975822897`*^9}, 
   3.6771660717734203`*^9, 3.6771661078078833`*^9, {3.6771661424781446`*^9, 
   3.6771662209340825`*^9}, 3.677166598391345*^9, 3.6771675173625574`*^9, {
   3.677167713292902*^9, 3.677167728113928*^9}, {3.677169073340288*^9, 
   3.6771691051401443`*^9}, 3.677169200926712*^9, 3.677169258233612*^9, 
   3.677169288307666*^9, {3.6771694096082783`*^9, 3.67716943338372*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"calcG1", "[", 
    RowBox[{"AP_", ",", "AR_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"ctL10", "[", 
     RowBox[{"AP", ",", "AR"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calcG1", "[", 
   RowBox[{"AP", ",", "AR"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.677169008767974*^9, 3.6771691036269417`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"Cos", "[", "AP", "]"}], " ", 
        RowBox[{"Sin", "[", "AR", "]"}]}]},
      {
       RowBox[{"-", 
        RowBox[{"Sin", "[", "AP", "]"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "AP", "]"}]}], " ", 
        RowBox[{"Cos", "[", "AR", "]"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6771690733558884`*^9, 3.6771691051401443`*^9}, 
   3.6771692009423122`*^9, 3.6771692582492123`*^9, 3.677169288307666*^9, {
   3.6771694096238785`*^9, 3.67716943338372*^9}}]
}, Open  ]],

Cell["\<\

Some examples:\
\>", "Text",
 CellChangeTimes->{{3.677168878527545*^9, 3.677168897175578*^9}, {
  3.677169003947565*^9, 3.6771690063031693`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"calcG1", "[", 
   RowBox[{
    RowBox[{"\[Pi]", "/", "4"}], ",", "0"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.677168901247185*^9, {3.6771689383676505`*^9, 3.6771689721623096`*^9}, {
   3.677169176039668*^9, 3.677169206636322*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["2"]]}]},
      {
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["2"]]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6771692009579124`*^9, 3.6771692582648125`*^9, 3.6771692883232656`*^9, {
   3.6771694096394787`*^9, 3.6771694333993196`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"calcG1", "[", 
   RowBox[{"0", ",", 
    RowBox[{"\[Pi]", "/", "4"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.677169284236058*^9, 3.6771692869036627`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox["1", 
        SqrtBox["2"]]},
      {"0"},
      {
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["2"]]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6771692883388653`*^9, {3.6771694096394787`*^9, 3.67716943341492*^9}}]
}, Open  ]],

Cell["\<\
By definition, TiltAngleX + \[Pi]/2 gives the angle between the gravity \
vector and the X axis. Solving for TiltX as a function of the gravity vector \
gives:\
\>", "Text",
 CellChangeTimes->{{3.677166380227762*^9, 3.677166537101437*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SolveX1", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", " ", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", "TiltX1"}], "]"}], " ", "==",
      " ", 
     RowBox[{
      RowBox[{"calcG1", "[", 
       RowBox[{"AP", ",", "AR"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ",", "TiltX1"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6771654903898*^9, 3.677165506618829*^9}, {
  3.6771655507261057`*^9, 3.6771655795775566`*^9}, {3.677165614373618*^9, 
  3.6771656171192226`*^9}, {3.677165756981868*^9, 3.6771658203143787`*^9}, {
  3.6771658667832603`*^9, 3.677165879216482*^9}, {3.677165913076542*^9, 
  3.67716593481138*^9}, {3.677166079029433*^9, 3.677166079216633*^9}, {
  3.6771693921594477`*^9, 3.6771694244751043`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"TiltX1", "\[Rule]", 
     RowBox[{"ConditionalExpression", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ArcSin", "[", 
          RowBox[{
           RowBox[{"Cos", "[", "AP", "]"}], " ", 
           RowBox[{"Sin", "[", "AR", "]"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "1", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"TiltX1", "\[Rule]", 
     RowBox[{"ConditionalExpression", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "+", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          RowBox[{"Cos", "[", "AP", "]"}], " ", 
          RowBox[{"Sin", "[", "AR", "]"}]}], "]"}], "+", 
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "1", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.677165669765715*^9, 3.677165779309507*^9, 3.6771658234031844`*^9, 
   3.677165908769934*^9, {3.6771659590432224`*^9, 3.67716599759789*^9}, 
   3.67716607178902*^9, 3.6771661078234835`*^9, {3.6771661424937444`*^9, 
   3.677166220949682*^9}, 3.6771665984069448`*^9, 3.6771675173781576`*^9, {
   3.677167713308502*^9, 3.677167728113928*^9}, {3.6771690733714886`*^9, 
   3.6771691051557446`*^9}, 3.6771692009735126`*^9, 3.6771692582648125`*^9, 
   3.6771692883388653`*^9, {3.6771694096550784`*^9, 3.67716943341492*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TiltX", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SolveX1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.677165938227786*^9, 3.677165995273486*^9}, {
  3.677166067218212*^9, 3.677166069527016*^9}, {3.677166125112314*^9, 
  3.6771661253463144`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"Cos", "[", "AP", "]"}], " ", 
    RowBox[{"Sin", "[", "AR", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.6771659590432224`*^9, 3.67716599759789*^9}, 
   3.67716607180462*^9, 3.6771661078234835`*^9, {3.6771661424937444`*^9, 
   3.6771662209652824`*^9}, 3.6771665984069448`*^9, 3.6771675173781576`*^9, {
   3.677167713308502*^9, 3.677167728129528*^9}, {3.6771690733870883`*^9, 
   3.6771691051713443`*^9}, 3.6771692009735126`*^9, 3.6771692582804127`*^9, 
   3.6771692883544655`*^9, {3.677169409670678*^9, 3.67716943343052*^9}}]
}, Open  ]],

Cell["\<\
By definition, TiltAngleY + \[Pi]/2 gives the angle between the gravity \
vector and the Y axis. Solving for TiltY as a function of the gravity vector \
gives:\
\>", "Text",
 CellChangeTimes->{{3.677166380227762*^9, 3.677166537101437*^9}, {
  3.677166578031309*^9, 3.677166588688128*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SolveY1", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", " ", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", "TiltY1"}], "]"}], " ", "==",
      " ", 
     RowBox[{
      RowBox[{"calcG1", "[", 
       RowBox[{"AP", ",", "AR"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], ",", "TiltY1"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.677166082664239*^9, 3.6771661059202805`*^9}, 
   3.677166592868935*^9, {3.6771694298415136`*^9, 3.6771694303251143`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"TiltY1", "\[Rule]", 
     RowBox[{"ConditionalExpression", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "-", 
        RowBox[{"ArcSin", "[", 
         RowBox[{"Sin", "[", "AP", "]"}], "]"}], "+", 
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "1", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"TiltY1", "\[Rule]", 
     RowBox[{"ConditionalExpression", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ArcSin", "[", 
         RowBox[{"Sin", "[", "AP", "]"}], "]"}], "+", 
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"C", "[", "1", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6771661078390837`*^9, {3.6771661425093446`*^9, 3.6771662209652824`*^9}, 
   3.6771665984225445`*^9, 3.677167517393758*^9, {3.677167713324102*^9, 
   3.677167728129528*^9}, {3.6771690733870883`*^9, 3.677169105186944*^9}, 
   3.6771692009891124`*^9, 3.6771692582804127`*^9, 3.6771692883544655`*^9, {
   3.6771694096862783`*^9, 3.6771694334461203`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TiltY", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SolveY1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.6771661282791195`*^9, 3.6771662186866784`*^9}, 
   3.6771665951153393`*^9, {3.677167503880134*^9, 3.677167515194154*^9}}],

Cell[BoxData[
 RowBox[{"ArcSin", "[", 
  RowBox[{"Sin", "[", "AP", "]"}], "]"}]], "Output",
 CellChangeTimes->{
  3.677167517393758*^9, {3.677167713324102*^9, 3.6771677281451283`*^9}, {
   3.6771690734026885`*^9, 3.677169105186944*^9}, 3.6771692009891124`*^9, 
   3.677169258296013*^9, 3.6771692883700657`*^9, {3.6771694096862783`*^9, 
   3.6771694334461203`*^9}}]
}, Open  ]],

Cell["\<\
Here are functions that give the tilt angles in terms of the pitch and roll:
\
\>", "Text",
 CellChangeTimes->{
  3.677166650290036*^9, {3.677167536927992*^9, 3.677167589179284*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"calcTiltX", "[", 
    RowBox[{"AP_", ",", "AR_"}], "]"}], "=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"Cos", "[", "AP", "]"}], " ", 
       RowBox[{"Sin", "[", "AR", "]"}]}], "]"}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"calcTiltY", "[", 
    RowBox[{"AP_", ",", "AR_"}], "]"}], "=", " ", "AP"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6771675949522943`*^9, 3.677167711715299*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calcTiltX", "[", 
  RowBox[{"AP", ",", "AR"}], "]"}]], "Input",
 CellChangeTimes->{{3.6771677165689077`*^9, 3.6771677254463234`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"Cos", "[", "AP", "]"}], " ", 
    RowBox[{"Sin", "[", "AR", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.677167728160728*^9, {3.677169073418288*^9, 3.677169105202544*^9}, 
   3.677169201004712*^9, 3.677169258311613*^9, 3.677169288385666*^9, {
   3.6771694097018785`*^9, 3.67716943346172*^9}}]
}, Open  ]]
},
WindowSize->{1013, 832},
WindowMargins->{{Automatic, 274}, {26, Automatic}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Text"], FontColor -> RGBColor[0.5, 0, 0.5]]}, Visible -> False,
   FrontEndVersion -> "10.0 for Microsoft Windows (64-bit) (July 1, 2014)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 92, 1, 30, "Text"],
Cell[653, 23, 511, 11, 72, "Input"],
Cell[1167, 36, 350, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[1542, 46, 433, 10, 72, "Input"],
Cell[1978, 58, 1320, 31, 71, "Output"],
Cell[3301, 91, 1320, 31, 71, "Output"],
Cell[4624, 124, 1320, 31, 71, "Output"]
}, Open  ]],
Cell[5959, 158, 1145, 19, 182, "Text"],
Cell[7107, 179, 1002, 15, 87, "Text"],
Cell[8112, 196, 572, 11, 87, "Text"],
Cell[CellGroupData[{
Cell[8709, 211, 1350, 33, 92, "Input"],
Cell[10062, 246, 1737, 44, 71, "Output"],
Cell[11802, 292, 1737, 44, 71, "Output"]
}, Open  ]],
Cell[13554, 339, 429, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[14008, 350, 393, 9, 52, "Input"],
Cell[14404, 361, 1205, 29, 71, "Output"]
}, Open  ]],
Cell[15624, 393, 490, 9, 49, "Text"],
Cell[CellGroupData[{
Cell[16139, 406, 525, 11, 52, "Input"],
Cell[16667, 419, 1467, 37, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18171, 461, 488, 14, 52, "Input"],
Cell[18662, 477, 1124, 32, 71, "Output"]
}, Open  ]],
Cell[19801, 512, 156, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[19982, 521, 293, 8, 31, "Input"],
Cell[20278, 531, 927, 29, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21242, 565, 213, 5, 31, "Input"],
Cell[21458, 572, 847, 27, 103, "Output"]
}, Open  ]],
Cell[22320, 602, 249, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[22594, 611, 856, 20, 31, "Input"],
Cell[23453, 633, 1603, 39, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25093, 677, 540, 15, 52, "Input"],
Cell[25636, 694, 611, 11, 31, "Output"]
}, Open  ]],
Cell[26262, 708, 298, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[26585, 718, 586, 16, 31, "Input"],
Cell[27174, 736, 1270, 32, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28481, 773, 470, 12, 31, "Input"],
Cell[28954, 787, 364, 7, 31, "Output"]
}, Open  ]],
Cell[29333, 797, 192, 5, 49, "Text"],
Cell[29528, 804, 568, 17, 72, "Input"],
Cell[CellGroupData[{
Cell[30121, 825, 157, 3, 31, "Input"],
Cell[30281, 830, 380, 9, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
