(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11219,        328]
NotebookOptionsPosition[     10463,        299]
NotebookOutlinePosition[     10899,        317]
CellTagsIndexPosition[     10856,        314]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ParentDirectory", "[", 
      RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<Lib\>\"", 
     ",", "\"\<MathTensor.m\>\""}], "}"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"$Assumptions", " ", "&&", " ", 
    RowBox[{"Reals", "[", 
     RowBox[{"X", ",", "Y", ",", "R", ",", "A"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"$Assumptions", " ", "&&", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"X", "^", "2"}], "+", 
      RowBox[{"Y", "^", "2"}]}], ">", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"$Assumptions", " ", "&&", " ", 
    RowBox[{"R", ">", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"$Assumptions", " ", "&&", " ", 
    RowBox[{"Y", ">", "0"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6731236585903454`*^9, 3.6731237223164563`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Gadd", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gauu", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67321997789858*^9, 3.673219981143386*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ctRbFa", "[", 
    RowBox[{"Xa_", ",", "Ya_"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"Xa", "^", "2"}], "+", 
     RowBox[{"Ya", "^", "2"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ctAbFa", "[", 
    RowBox[{"Xa_", ",", "Ya_"}], "]"}], ":=", 
   RowBox[{"ArcCos", "[", 
    RowBox[{"Xa", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"Xa", "^", "2"}], "+", 
       RowBox[{"Ya", "^", "2"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ctXaFb", "[", 
    RowBox[{"Rb_", ",", "Ab_"}], "]"}], ":=", 
   RowBox[{"Rb", " ", 
    RowBox[{"Cos", "[", "Ab", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ctYaFb", "[", 
    RowBox[{"Rb_", ",", "Ab_"}], "]"}], ":=", 
   RowBox[{"Rb", " ", 
    RowBox[{"Sin", "[", "Ab", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672232194502634*^9, 3.672232195750636*^9}, 
   3.672235233865935*^9, {3.673122678830637*^9, 3.6731226998906736`*^9}, {
   3.6731227318083296`*^9, 3.6731228830817933`*^9}, {3.673122914859049*^9, 
   3.673122917901054*^9}, {3.673123640119913*^9, 3.6731236534267364`*^9}, 
   3.6732199793493824`*^9, {3.673220287153519*^9, 3.673220292941129*^9}, {
   3.673220343173217*^9, 3.673220345528821*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CTabFb", "[", 
    RowBox[{"Rb_", ",", "Ab_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "CT", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CT", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"ctXaFb", "[", 
              RowBox[{"Rb", ",", "Ab"}], "]"}], ",", "Rb"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"ctXaFb", "[", 
              RowBox[{"Rb", ",", "Ab"}], "]"}], ",", "Ab"}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", "         ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"ctYaFb", "[", 
              RowBox[{"Rb", ",", "Ab"}], "]"}], ",", "Rb"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"ctYaFb", "[", 
              RowBox[{"Rb", ",", "Ab"}], "]"}], ",", "Ab"}], "]"}]}], "}"}]}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FullSimplify", "[", "CT", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CTbaFa", "[", 
    RowBox[{"Xa_", ",", "Ya_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "CT", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CT", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"ctRbFa", "[", 
              RowBox[{"Xa", ",", "Ya"}], "]"}], ",", "Xa"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"ctRbFa", "[", 
              RowBox[{"Xa", ",", "Ya"}], "]"}], ",", "Ya"}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", "         ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"ctAbFa", "[", 
              RowBox[{"Xa", ",", "Ya"}], "]"}], ",", "Xa"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"ctAbFa", "[", 
              RowBox[{"Xa", ",", "Ya"}], "]"}], ",", "Ya"}], "]"}]}], "}"}]}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FullSimplify", "[", "CT", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673122928789873*^9, 3.6731231544442663`*^9}, {
   3.673123270056068*^9, 3.6731232729264727`*^9}, {3.6731235812142105`*^9, 
   3.6731235834138145`*^9}, {3.673219824019912*^9, 3.6732198268747168`*^9}, 
   3.6732199364337077`*^9, {3.6732199680237627`*^9, 3.673219969006564*^9}, {
   3.673220170746116*^9, 3.6732202099021845`*^9}, {3.673220263691078*^9, 
   3.673220281256709*^9}, {3.6732203744668713`*^9, 3.673220403451722*^9}, {
   3.673220463745827*^9, 3.6732205058347006`*^9}, {3.6732205435555663`*^9, 
   3.673220543773967*^9}, {3.6732206143328896`*^9, 3.67322061458249*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CTabFb", "[", 
   RowBox[{"R", ",", "A"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6731232811164875`*^9, 3.6731233234549613`*^9}, {
  3.673123476584828*^9, 3.673123476787628*^9}, {3.6732198972464395`*^9, 
  3.6732199296632957`*^9}, {3.673220386010892*^9, 3.6732203986937137`*^9}, {
  3.6732205206547265`*^9, 3.6732205208419266`*^9}, {3.6732207316762943`*^9, 
  3.6732207318790946`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "A", "]"}], 
      RowBox[{
       RowBox[{"-", "R"}], " ", 
       RowBox[{"Sin", "[", "A", "]"}]}]},
     {
      RowBox[{"Sin", "[", "A", "]"}], 
      RowBox[{"R", " ", 
       RowBox[{"Cos", "[", "A", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6732201382824593`*^9, {3.6732201734605207`*^9, 3.6732202667954836`*^9}, 
   3.673220299976742*^9, 3.6732203575096416`*^9, 3.6732203930153036`*^9, {
   3.6732207201790743`*^9, 3.673220750177926*^9}, 3.673220792859601*^9, 
   3.6732208889869685`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CTbaFa", "[", 
   RowBox[{"X", ",", "Y"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.673123482388038*^9, 3.6731234921848555`*^9}, 
   3.6732199077296576`*^9, {3.6732202292930183`*^9, 3.6732202380914335`*^9}, {
   3.6732203905505*^9, 3.6732203907532997`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["X", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["X", "2"], "+", 
         SuperscriptBox["Y", "2"]}]]], 
      FractionBox["Y", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["X", "2"], "+", 
         SuperscriptBox["Y", "2"]}]]]},
     {
      RowBox[{"-", 
       FractionBox["Y", 
        RowBox[{
         SuperscriptBox["X", "2"], "+", 
         SuperscriptBox["Y", "2"]}]]}], 
      FractionBox["X", 
       RowBox[{
        SuperscriptBox["X", "2"], "+", 
        SuperscriptBox["Y", "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.67322024175744*^9, 3.6732202668266835`*^9}, 
   3.6732203000079412`*^9, 3.673220357525242*^9, 3.673220393030904*^9, {
   3.6732207201790743`*^9, 3.673220750177926*^9}, 3.673220792875201*^9, 
   3.6732208890025682`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.673123564428581*^9, 3.6731235646469817`*^9}, {
   3.6731237092592335`*^9, 3.673123709462034*^9}, {3.673220509453907*^9, 
   3.673220740006709*^9}, 3.67322088413536*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6732207433139143`*^9, 3.6732207467303205`*^9}, {
   3.673220788179593*^9, 3.6732207891935945`*^9}, 3.6732208857421627`*^9}]
},
WindowSize->{1295, 832},
WindowMargins->{{123, Automatic}, {Automatic, 48}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1224, 33, 175, "Input"],
Cell[1785, 55, 438, 13, 60, "Input"],
Cell[2226, 70, 1337, 37, 106, "Input"],
Cell[3566, 109, 3153, 80, 244, "Input"],
Cell[CellGroupData[{
Cell[6744, 193, 489, 9, 60, "Input"],
Cell[7236, 204, 1073, 29, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8346, 238, 359, 7, 60, "Input"],
Cell[8708, 247, 1344, 40, 104, "Output"]
}, Open  ]],
Cell[10067, 290, 217, 3, 36, "Input"],
Cell[10287, 295, 172, 2, 36, "Input"]
}
]
*)

(* End of internal cache information *)
